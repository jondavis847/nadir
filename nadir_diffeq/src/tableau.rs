pub struct ButcherTableau<const STAGES: usize> {
    pub a: [[f64; STAGES]; STAGES],
    pub b: [f64; STAGES],
    pub b_star: Option<[f64; STAGES]>,
    pub c: [f64; STAGES],
    pub order: usize,
}

impl ButcherTableau<4> {
    // usage is ButcherTableau::<4>::RK4
    pub const RK4: Self = Self {
        a: [
            [0., 0., 0., 0.],
            [1. / 2., 0., 0., 0.],
            [0., 1. / 2., 0., 0.],
            [0., 0., 1., 0.],
        ],
        b: [1. / 6., 1. / 3., 1. / 3., 1. / 6.],
        b_star: None,
        c: [0., 1.0 / 2.0, 1.0 / 2.0, 1.0],
        order: 4,
    };
}
impl ButcherTableau<7> {
    // usage is ButcherTableau::<7>::DORMANDRINCE45
    pub const DORMANDPRINCE45: Self = Self {
        a: [
            [0., 0., 0., 0., 0., 0., 0.],
            [1. / 5., 0., 0., 0., 0., 0., 0.],
            [3. / 40., 9. / 40., 0., 0., 0., 0., 0.],
            [44. / 45., -56. / 15., 32. / 9., 0., 0., 0., 0.],
            [
                19372. / 6561.,
                -25360. / 2187.,
                64448. / 6561.,
                -212. / 729.,
                0.,
                0.,
                0.,
            ],
            [
                9017. / 3168.,
                -355. / 33.,
                46732. / 5247.,
                49. / 176.,
                -5103. / 18656.,
                0.,
                0.,
            ],
            [
                35. / 384.,
                0.,
                500. / 1113.,
                125. / 192.,
                -2187. / 6784.,
                11. / 84.,
                0.,
            ],
        ],
        b: [
            35. / 384.,
            0.,
            500. / 1113.,
            125. / 192.,
            -2187. / 6784.,
            11. / 84.,
            0.,
        ],
        b_star: Some([
            5179. / 57600.,
            0.,
            7571. / 16695.,
            393. / 640.,
            -92097. / 339200.,
            187. / 2100.,
            1. / 40.,
        ]),
        c: [0., 1. / 5., 3. / 10., 4. / 5., 8. / 9., 1.0, 1.0],
        order: 5,
    };

    pub const TSITOURAS5: Self = Self {
        a: [
            [0., 0., 0., 0., 0., 0., 0.],
            [0.161, 0., 0., 0., 0., 0., 0.],
            [-0.008480655492356992, 0.335480655492357, 0., 0., 0., 0., 0.],
            [
                2.897153057105495,
                -6.359448489975075,
                4.362295432869581,
                0.,
                0.,
                0.,
                0.,
            ],
            [
                5.32586482843926,
                -11.74888356406283,
                7.495539342889836,
                -0.09249506636175525,
                0.,
                0.,
                0.,
            ],
            [
                5.86145544294642,
                -12.92096931784711,
                8.159367898576159,
                -0.071584973281401,
                -0.028269050394068383,
                0.,
                0.,
            ],
            [
                0.09646076681806523,
                0.01,
                0.4798896504144996,
                1.379008574103742,
                -3.290069515436081,
                2.324710524099774,
                0.,
            ],
        ],
        b: [
            0.09646076681806523,
            0.01,
            0.4798896504144996,
            1.379008574103742,
            -3.290069515436081,
            2.324710524099774,
            0.0,
        ],
        b_star: Some([
            0.001780011052226,
            0.000816434459657,
            -0.007880878010262,
            0.144711007173263,
            -0.582357165452555,
            0.458082105929187,
            0.015151515151515152,
        ]),
        c: [0.0, 0.161, 0.327, 0.9, 0.9800255409045097, 1., 1.],
        order: 5,
    };

    pub const NEW45: Self = Self {
        a: [
            [0., 0., 0., 0., 0., 0., 0.],
            [0.14022440898664771, 0., 0., 0., 0., 0., 0.],
            [-0.0759822776564498, 0.4186221624134168, 0., 0., 0., 0., 0.],
            [
                8.3218998874618880,
                -15.2489157586992278,
                8.0363405219741709,
                0.,
                0.,
                0.,
                0.,
            ],
            [
                5.222667097410808,
                -9.5852933284904335,
                5.35617994486048108,
                0.02329660612506932,
                0.,
                0.,
                0.,
            ],
            [
                4.68849813729819414,
                -8.6009968215078711,
                4.88059228918943447,
                0.0144914646361612,
                0.0174149303840813,
                0.,
                0.,
            ],
            [
                0.1023659690365102,
                0.0,
                0.5224013850127148,
                0.6073190283934926,
                -7.1585072358744018,
                6.9264208534316842,
                0.,
            ],
        ],
        b: [
            0.1023659690365102,
            0.0,
            0.5224013850127148,
            0.6073190283934926,
            -7.1585072358744018,
            6.9264208534316842,
            0.,
        ],
        b_star: Some([
            0.1011697031721691,
            0.0,
            0.5263726397826966,
            0.5535457487059638,
            -6.7256950583938850,
            6.5396069667330555,
            0.005,
        ]),
        c: [
            0.0,
            0.14022440898664771,
            0.3426398847569670,
            1.1093246507368311,
            1.01685031990592488,
            1.,
            1.,
        ],
        order: 5,
    };
}

impl ButcherTableau<9> {
    pub const VERNER6: Self = Self {
        a: [
            [0., 0., 0., 0., 0., 0., 0., 0., 0.],
            [0.6e-1, 0., 0., 0., 0., 0., 0., 0., 0.],
            [
                0.1923996296296296296296296296296296296296e-1,
                0.7669337037037037037037037037037037037037e-1,
                0.,
                0.,
                0.,
                0.,
                0.,
                0.,
                0.,
            ],
            [0.35975e-1, 0., 0.107925, 0., 0., 0., 0., 0., 0.],
            [
                1.318683415233148260919747276431735612861,
                0.,
                -5.042058063628562225427761634715637693344,
                4.220674648395413964508014358283902080483,
                0.,
                0.,
                0.,
                0.,
                0.,
            ],
            [
                -41.87259166432751461803757780644346812905,
                0.,
                159.4325621631374917700365669070346830453,
                -122.1192135650100309202516203389242140663,
                5.531743066200053768252631238332999150076,
                0.,
                0.,
                0.,
                0.,
            ],
            [
                -54.43015693531650433250642051294142461271,
                0.,
                207.0672513650184644273657173866509835987,
                -158.6108137845899991828742424365058599469,
                6.991816585950242321992597280791793907096,
                -0.1859723106220323397765171799549294623692e-1,
                0.,
                0.,
                0.,
            ],
            [
                -54.66374178728197680241215648050386959351,
                0.,
                207.9528062553893734515824816699834244238,
                -159.2889574744995071508959805871426654216,
                7.018743740796944434698170760964252490817,
                -0.1833878590504572306472782005141738268361e-1,
                -0.5119484997882099077875432497245168395840e-3,
                0.,
                0.,
            ],
            [
                0.3438957868357036009278820124728322386520e-1,
                0.,
                0.,
                0.2582624555633503404659558098586120858767,
                0.4209371189673537150642551514069801967032,
                4.405396469669310170148836816197095664891,
                -176.4831190242986576151740942499002125029,
                172.3641334014150730294022582711902413315,
                0.,
            ],
        ],
        b: [
            0.3438957868357036009278820124728322386520e-1,
            0.,
            0.,
            0.2582624555633503404659558098586120858767,
            0.4209371189673537150642551514069801967032,
            4.405396469669310170148836816197095664891,
            -176.4831190242986576151740942499002125029,
            172.3641334014150730294022582711902413315,
            0.,
        ],
        b_star: Some([
            0.4909967648382489730906854927971225836479e-1,
            0.,
            0.,
            0.2251112229516524153401395320539875329485,
            0.4694682253029562039431948525047387412553,
            0.8065792249988867707634161808995217981443,
            0.,
            -0.6071194891777959797672951465256217122488,
            0.5686113944047569241147603178766138153594e-1,
        ]),
        c: [
            0.,
            0.6e-1,
            0.9593333333333333333333333333333333333333e-1,
            0.1439,
            0.4973,
            0.9725,
            0.9995,
            1.0,
            1.0,
        ],
        order: 6,
    };
}

pub struct ButcherTableau<const STAGES: usize> {
    pub a: [[f64; STAGES]; STAGES],
    pub b: [f64; STAGES],
    pub b_star: Option<[f64; STAGES]>,
    pub c: [f64; STAGES],
    pub order: usize,
}

impl ButcherTableau<4> {
    // usage is ButcherTableau::<4>::RK4
    pub const RK4: Self = Self {
        a: [
            [0., 0., 0., 0.],
            [1. / 2., 0., 0., 0.],
            [0., 1. / 2., 0., 0.],
            [0., 0., 1., 0.],
        ],
        b: [1. / 6., 1. / 3., 1. / 3., 1. / 6.],
        b_star: None,
        c: [0., 1.0 / 2.0, 1.0 / 2.0, 1.0],
        order: 4,
    };
}
impl ButcherTableau<7> {
    // usage is ButcherTableau::<7>::DORMANDRINCE45
    pub const DORMANDPRINCE45: Self = Self {
        a: [
            [0., 0., 0., 0., 0., 0., 0.],
            [1. / 5., 0., 0., 0., 0., 0., 0.],
            [3. / 40., 9. / 40., 0., 0., 0., 0., 0.],
            [44. / 45., -56. / 15., 32. / 9., 0., 0., 0., 0.],
            [
                19372. / 6561.,
                -25360. / 2187.,
                64448. / 6561.,
                -212. / 729.,
                0.,
                0.,
                0.,
            ],
            [
                9017. / 3168.,
                -355. / 33.,
                46732. / 5247.,
                49. / 176.,
                -5103. / 18656.,
                0.,
                0.,
            ],
            [
                35. / 384.,
                0.,
                500. / 1113.,
                125. / 192.,
                -2187. / 6784.,
                11. / 84.,
                0.,
            ],
        ],
        b: [
            35. / 384.,
            0.,
            500. / 1113.,
            125. / 192.,
            -2187. / 6784.,
            11. / 84.,
            0.,
        ],
        b_star: Some([
            5179. / 57600.,
            0.,
            7571. / 16695.,
            393. / 640.,
            -92097. / 339200.,
            187. / 2100.,
            1. / 40.,
        ]),
        c: [0., 1. / 5., 3. / 10., 4. / 5., 8. / 9., 1.0, 1.0],
        order: 5,
    };

    pub const TSITOURAS5: Self = Self {
        a: [
            [0., 0., 0., 0., 0., 0., 0.],
            [0.161, 0., 0., 0., 0., 0., 0.],
            [-0.008480655492356989, 0.335480655492357, 0., 0., 0., 0., 0.],
            [
                2.8971530571054935,
                -6.359448489975075,
                4.3622954328695815,
                0.,
                0.,
                0.,
                0.,
            ],
            [
                5.325864828439257,
                -11.748883564062828,
                7.4955393428898365,
                -0.09249506636175525,
                0.,
                0.,
                0.,
            ],
            [
                5.86145544294642,
                -12.92096931784711,
                8.159367898576159,
                -0.071584973281401,
                -0.028269050394068383,
                0.,
                0.,
            ],
            [
                0.09646076681806523,
                0.01,
                0.4798896504144996,
                1.379008574103742,
                -3.290069515436081,
                2.324710524099774,
                0.,
            ],
        ],
        b: [
            0.09468075576583945,
            0.009183565540343254,
            0.4877705284247616,
            1.234297566930479,
            -2.7077123499835256,
            1.866628418170587,
            0.015151515151515152,
        ],
        b_star: Some([
            -0.00178001105222577714,
            -0.0008164344596567469,
            0.007880878010261995,
            -0.1447110071732629,
            0.5823571654525552,
            -0.45808210592918697,
            0.015151515151515152,
        ]),
        c: [0.0, 0.161, 0.327, 0.9, 0.9800255409045097, 1., 1.],
        order: 5,
    };
}
